# LOD ç³»ç»Ÿå¿«é€Ÿå‚è€ƒ

## ðŸŽ¯ æ ¸å¿ƒæ¦‚å¿µ

**ä»Ž Level 0 å¼€å§‹ï¼ŒLevel 0 = 4 ä¸ªç“¦ç‰‡**

```
Level 0 â†’ 4 tiles   (2Ã—2)
Level 1 â†’ 8 tiles   (4Ã—2)
Level 2 â†’ 16 tiles  (4Ã—4)
Level 3 â†’ 32 tiles  (8Ã—4)
Level 4 â†’ 64 tiles  (8Ã—8)
Level 5 â†’ 128 tiles (16Ã—8)
Level 6 â†’ 256 tiles (16Ã—16)
Level 7 â†’ 512 tiles (32Ã—16)
```

## ðŸ“Š å¿«é€ŸæŸ¥è¯¢è¡¨

| Level | ç“¦ç‰‡æ•° | ç“¦ç‰‡å¤§å° | ç›¸æœºé«˜åº¦ |
|-------|-------|---------|---------|
| 0 | 4 | 180Â°Ã—90Â° | > 50,000 km |
| 1 | 8 | 90Â°Ã—90Â° | 20,000-50,000 km |
| 2 | 16 | 90Â°Ã—45Â° | 10,000-20,000 km |
| 3 | 32 | 45Â°Ã—45Â° | 5,000-10,000 km |
| 4 | 64 | 45Â°Ã—22.5Â° | 2,000-5,000 km |
| 5 | 128 | 22.5Â°Ã—22.5Â° | 1,000-2,000 km |
| 6 | 256 | 22.5Â°Ã—11.25Â° | 500-1,000 km |
| 7 | 512 | 11.25Â°Ã—11.25Â° | < 500 km |

## ðŸ”§ é…ç½®ä»£ç 

### å‰ç«¯ï¼ˆindex.jsï¼‰

```javascript
const LOD_LEVELS = [
  { maxHeight: 50000000, level: 0, tilesX: 2, tilesY: 2 },
  { maxHeight: 20000000, level: 1, tilesX: 4, tilesY: 2 },
  { maxHeight: 10000000, level: 2, tilesX: 4, tilesY: 4 },
  { maxHeight: 5000000, level: 3, tilesX: 8, tilesY: 4 },
  { maxHeight: 2000000, level: 4, tilesX: 8, tilesY: 8 },
  { maxHeight: 1000000, level: 5, tilesX: 16, tilesY: 8 },
  { maxHeight: 500000, level: 6, tilesX: 16, tilesY: 16 },
  { maxHeight: 0, level: 7, tilesX: 32, tilesY: 16 },
];
```

### åŽç«¯ï¼ˆbackend-example.jsï¼‰

```javascript
const LOD_CONFIG = {
  0: { tilesX: 2, tilesY: 2, total: 4 },
  1: { tilesX: 4, tilesY: 2, total: 8 },
  2: { tilesX: 4, tilesY: 4, total: 16 },
  3: { tilesX: 8, tilesY: 4, total: 32 },
  4: { tilesX: 8, tilesY: 8, total: 64 },
  5: { tilesX: 16, tilesY: 8, total: 128 },
  6: { tilesX: 16, tilesY: 16, total: 256 },
  7: { tilesX: 32, tilesY: 16, total: 512 },
};
```

## ðŸŒ Level 0 å¸ƒå±€

```
     -180Â°        0Â°        180Â°
  90Â° â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  (0,0)    â”‚  (1,0)    â”‚
   0Â° â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚  (0,1)    â”‚  (1,1)    â”‚
 -90Â° â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ“ è®¡ç®—å…¬å¼

### ç“¦ç‰‡å¤§å°

```javascript
tileSizeX = 360 / tilesX
tileSizeY = 180 / tilesY
```

### ç»çº¬åº¦ â†’ ç“¦ç‰‡åæ ‡

```javascript
tileX = floor((longitude + 180) / tileSizeX)
tileY = floor((90 - latitude) / tileSizeY)
```

### ç“¦ç‰‡åæ ‡ â†’ ç»çº¬åº¦èŒƒå›´

```javascript
west = tileX * tileSizeX - 180
east = (tileX + 1) * tileSizeX - 180
north = 90 - tileY * tileSizeY
south = 90 - (tileY + 1) * tileSizeY
```

## ðŸŽ® ä½¿ç”¨æ–¹æ³•

### 1. å¯åŠ¨ç³»ç»Ÿ

```bash
# ç»ˆç«¯ 1ï¼šå¯åŠ¨åŽç«¯
node backend-example.js

# ç»ˆç«¯ 2ï¼šå¯åŠ¨å‰ç«¯
npm run start:lod
```

### 2. è‡ªåŠ¨ LOD

- ç³»ç»Ÿæ ¹æ®ç›¸æœºé«˜åº¦è‡ªåŠ¨é€‰æ‹© Level
- ç¼©æ”¾åœ°çƒæŸ¥çœ‹ä¸åŒçº§åˆ«

### 3. æ‰‹åŠ¨ LOD

- åœ¨å³ä¾§é…ç½®é¢æ¿è¾“å…¥ Level (0-7)
- ç‚¹å‡»åœ°çƒåŠ è½½æŒ‡å®šçº§åˆ«çš„ç“¦ç‰‡

### 4. æŸ¥çœ‹ä¿¡æ¯

æ‰“å¼€æµè§ˆå™¨æŽ§åˆ¶å°ï¼ˆF12ï¼‰ï¼š

```
LOD Level 0: 2x2 = 4 ä¸ªç“¦ç‰‡
ä¸­å¿ƒç“¦ç‰‡: (0, 0), ç“¦ç‰‡å¤§å°: 180.00Â° x 90.00Â°
```

## ðŸ”— API è¯·æ±‚æ ¼å¼

```
GET http://localhost:4433/api/tile?
  ncType=so&
  timeType=0&
  year=2024&
  month=1&
  day=1&
  hour=0&
  depth=0&
  level=0&        â† Level 0-7
  tileX=0&        â† ç“¦ç‰‡ X åæ ‡
  tileY=0         â† ç“¦ç‰‡ Y åæ ‡
```

## ðŸ“Š ç“¦ç‰‡åæ ‡èŒƒå›´

| Level | tileX èŒƒå›´ | tileY èŒƒå›´ |
|-------|-----------|-----------|
| 0 | 0-1 | 0-1 |
| 1 | 0-3 | 0-1 |
| 2 | 0-3 | 0-3 |
| 3 | 0-7 | 0-3 |
| 4 | 0-7 | 0-7 |
| 5 | 0-15 | 0-7 |
| 6 | 0-15 | 0-15 |
| 7 | 0-31 | 0-15 |

## ðŸŽ¨ ç“¦ç‰‡å‘½åè§„åˆ™

```
{level}_{tileX}_{tileY}.png

ç¤ºä¾‹ï¼š
0_0_0.png   â†’ Level 0, ç“¦ç‰‡ (0,0)
0_1_0.png   â†’ Level 0, ç“¦ç‰‡ (1,0)
1_0_0.png   â†’ Level 1, ç“¦ç‰‡ (0,0)
7_31_15.png â†’ Level 7, ç“¦ç‰‡ (31,15)
```

## ðŸ’¡ å¸¸ç”¨æ“ä½œ

### åŠ è½½å…¨çƒè§†å›¾ï¼ˆLevel 0ï¼‰

```javascript
// åœ¨é…ç½®é¢æ¿è®¾ç½®
Level: 0

// æˆ–åœ¨ä»£ç ä¸­
viewer.camera.flyTo({
  destination: Cesium.Cartesian3.fromDegrees(0, 0, 50000000)
});
```

### åŠ è½½ç‰¹å®šåŒºåŸŸ

```javascript
// ç‚¹å‡»ç›®æ ‡ä½ç½®
// ç³»ç»Ÿè‡ªåŠ¨åŠ è½½å‘¨å›´ 3Ã—3 åŒºåŸŸçš„ç“¦ç‰‡
```

### åˆ‡æ¢æ—¶é—´

```javascript
// åœ¨æ—¶é—´è½´é¢æ¿
è¾“å…¥: 202401
ç‚¹å‡»: åº”ç”¨
// ç³»ç»Ÿæ¸…é™¤æ—§ç“¦ç‰‡ï¼Œé‡æ–°åŠ è½½
```

## ðŸ› æ•…éšœæŽ’é™¤

### é—®é¢˜ï¼šç“¦ç‰‡ä¸æ˜¾ç¤º

```bash
âœ“ æ£€æŸ¥åŽç«¯æ˜¯å¦å¯åŠ¨
âœ“ è®¿é—® http://localhost:4433/health
âœ“ æŸ¥çœ‹æµè§ˆå™¨æŽ§åˆ¶å°é”™è¯¯
âœ“ æ£€æŸ¥ç½‘ç»œè¯·æ±‚ï¼ˆF12 â†’ Networkï¼‰
```

### é—®é¢˜ï¼šè¾¹ç•Œé”™è¯¯

```bash
âœ“ ç¡®ä¿ tileX < tilesX
âœ“ ç¡®ä¿ tileY < tilesY
âœ“ æ£€æŸ¥ç»çº¬åº¦èŒƒå›´ [-180,180] Ã— [-90,90]
```

### é—®é¢˜ï¼šçº§åˆ«ä¸åˆ‡æ¢

```bash
âœ“ æ¸…é™¤é…ç½®é¢æ¿çš„ Level è¾“å…¥æ¡†
âœ“ è®©ç³»ç»Ÿè‡ªåŠ¨é€‰æ‹©
âœ“ åˆ·æ–°é¡µé¢
```

## ðŸ“š æ–‡æ¡£ç´¢å¼•

- `LODçº§åˆ«è¯´æ˜Ž.md` - è¯¦ç»†çº§åˆ«è¯´æ˜Ž
- `ä½¿ç”¨è¯´æ˜Ž.md` - å®Œæ•´ä½¿ç”¨æŒ‡å—
- `LODé‡‘å­—å¡”è¯´æ˜Ž.md` - é‡‘å­—å¡”ç»“æž„
- `BUGä¿®å¤è¯´æ˜Ž.md` - é—®é¢˜ä¿®å¤

## ðŸŽ¯ è®°ä½è¿™äº›

1. **Level 0 = 4 ä¸ªç“¦ç‰‡**ï¼ˆæœ€é‡è¦ï¼ï¼‰
2. çº§åˆ«è¶Šé«˜ï¼Œç“¦ç‰‡è¶Šå¤šï¼Œç»†èŠ‚è¶Šå¤š
3. ç³»ç»Ÿè‡ªåŠ¨æ ¹æ®ç›¸æœºé«˜åº¦é€‰æ‹©çº§åˆ«
4. å¯ä»¥æ‰‹åŠ¨è®¾ç½®çº§åˆ«ï¼ˆ0-7ï¼‰
5. åŽç«¯éœ€è¦æ”¯æŒæ‰€æœ‰çº§åˆ«

---

**å¿«é€Ÿå¼€å§‹**: `node backend-example.js` + `npm run start:lod`  
**é»˜è®¤ç«¯å£**: 4433 (åŽç«¯), 3001 (å‰ç«¯)  
**Level èŒƒå›´**: 0-7  
**Level 0**: 4 ä¸ªç“¦ç‰‡ âœ“
